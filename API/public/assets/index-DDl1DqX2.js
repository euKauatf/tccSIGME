import{r as l,j as e,b as L,e as ae,c as ne,u as re,d as le,L as ie,g as ce,f as de,v as me,h as ue,i as E,k as xe,l as fe,s as he,m as pe}from"./index-ClLVAdQ7.js";/* empty css              */function ge({isOpen:r,onClose:i,onConfirm:x,title:f,message:v}){const[h,n]=l.useState("");if(l.useEffect(()=>(r&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[r]),l.useEffect(()=>{r||n("")},[r]),!r)return null;const p=()=>{x(h)},j=b=>{b.key==="Enter"&&p()};return e.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50",onClick:i,children:e.jsxs("div",{className:"relative w-full max-w-md p-6 mx-4 rounded-lg shadow-xl bg-base-100",onClick:b=>b.stopPropagation(),children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-base-content",children:f}),e.jsx("p",{className:"mb-5 text-gray-600",children:v}),e.jsx("input",{type:"password",value:h,onChange:b=>n(b.target.value),onKeyDown:j,className:"w-full mb-6 input input-bordered",placeholder:"Digite sua senha",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:i,className:"btn btn-ghost",children:"Cancelar"}),e.jsx("button",{onClick:p,className:"btn btn-error",children:"Confirmar Ação"})]})]})})}function be({event:r,onClose:i}){const{isAdmin:x}=L();if(!r)return null;const f=async()=>{r&&r.id?await ae(r.id):alert("Evento não encontrado.")};return e.jsx("dialog",{id:"event_modal",className:"modal",open:!0,children:e.jsxs("div",{className:"w-11/12 max-w-lg modal-box",children:[e.jsx("h3",{className:"text-xl font-bold md:text-2xl",children:r.tema}),e.jsxs("p",{className:"pt-4 pb-2",children:[e.jsx("strong",{children:"Palestrante:"})," ",r.palestrante]}),e.jsxs("p",{className:"py-2",children:[e.jsx("strong",{children:"Vagas Restantes:"})," ",r.vagas_restantes]}),e.jsxs("p",{className:"py-2",children:[e.jsx("strong",{children:"Local:"})," ",r.local]}),e.jsxs("p",{className:"py-2",children:[e.jsx("strong",{children:"Horário:"})," ",r.horario_inicio," - ",r.horario_termino]}),e.jsxs("p",{className:"py-2 break-words",children:[e.jsx("strong",{children:"Descrição:"})," ",r.descricao]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{className:"btn",onClick:i,children:"Fechar"}),x&&e.jsx("button",{className:"btn btn-primary",onClick:f,children:"Gerar lista de presença"})]})]})})}const ve={success:{icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",colorClass:"text-success"},error:{icon:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",colorClass:"text-error"},info:{icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",colorClass:"text-info"}};function je({isOpen:r,onClose:i,title:x,message:f,status:v="info"}){if(l.useEffect(()=>(r&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[r]),!r)return null;const{icon:h,colorClass:n}=ve[v];return e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:i,children:e.jsxs("div",{className:"relative w-full max-w-md p-6 mx-4 rounded-lg shadow-xl bg-base-100",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`stroke-current shrink-0 h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:h})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2 text-base-content",children:x}),e.jsx("p",{className:"text-base-content text-opacity-80",children:f})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:i,className:"btn btn-primary",children:"Ok"})})]})})}function we({isOpen:r,onClose:i,onConfirm:x,title:f,message:v,confirmButtonText:h="Confirmar",confirmButtonType:n="btn-primary"}){return l.useEffect(()=>(r&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="unset"}),[r]),r?e.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50",onClick:i,children:e.jsxs("div",{className:"relative w-full max-w-md p-6 mx-4 rounded-lg shadow-xl bg-base-100",onClick:p=>p.stopPropagation(),children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-base-content",children:f}),e.jsx("p",{className:"mb-5 text-base-content text-opacity-80",children:v}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:i,className:"btn btn-ghost",children:"Cancelar"}),e.jsx("button",{onClick:x,className:`btn ${n}`,children:h})]})]})}):null}function Ce(){var z,O,D;const{isAdmin:r}=L(),[i,x]=l.useState([]),[f,v]=l.useState(null),h=ne(),[n,p]=l.useState(null),[j,b]=l.useState("Todos"),[$,S]=l.useState(null),[A,k]=l.useState(!0),[M,B]=l.useState(null),[I,y]=l.useState(!1),[F,d]=l.useState(!1),[N,m]=l.useState({title:"",message:"",status:"info"}),[u,g]=l.useState({isOpen:!1,title:"",message:"",buttonType:"btn-primary",onConfirm:()=>{}}),R=re(),[U]=le(),_=()=>{const s=U.get("filter");return s==="pendentes"||s==="selecionados"?s:"todos"},W=s=>{S(s)},V=()=>{S(null)},[w,C]=l.useState(_),q=["Segunda","Terça","Quarta","Quinta","Sexta"];l.useEffect(()=>{var t;(t=h.state)!=null&&t.message&&(v(h.state.message),window.history.replaceState({},document.title)),(async()=>{k(!0);try{const[o,a]=await Promise.all([ce(),de()]);x(o.data),p(a.data)}catch(o){console.error("Erro ao buscar dados:",o),B("Não foi possível carregar os dados. Tente novamente mais tarde.")}finally{k(!1)}})()},[h]);const G=s=>{R(`/events/edit/${s}`)},K=s=>{var o;const t=((o=i.find(a=>a.id===s))==null?void 0:o.tema)||"este evento";g({isOpen:!0,title:"Confirmar Exclusão",message:`Você tem certeza que deseja excluir o evento "${t}"?`,buttonType:"btn-error",onConfirm:()=>Q(s)})},Q=async s=>{try{await xe(s),x(t=>t.filter(o=>o.id!==s)),m({title:"Sucesso",message:"O evento foi excluído com sucesso.",status:"success"}),d(!0)}catch(t){console.error("Erro ao excluir evento:",t),m({title:"Erro",message:"Não foi possível excluir o evento.",status:"error"}),d(!0)}finally{g({...u,isOpen:!1})}},H=s=>{var o;const t=((o=i.find(a=>a.id===s))==null?void 0:o.tema)||"este evento";g({isOpen:!0,title:"Confirmar Inscrição",message:`Você deseja se inscrever no evento "${t}"?`,buttonType:"btn-success",onConfirm:()=>J(s)})},J=async s=>{var t,o;try{await he(s);const a=i.find(c=>c.id===s);if(a&&n){const c={...a,pivot:{status:"inscrito"}};p({...n,eventos:[...n.eventos||[],c]})}m({title:"Inscrição Realizada!",message:"Sua inscrição foi registrada com sucesso. Aguarde o sorteio.",status:"success"}),d(!0)}catch(a){console.error("Erro ao se inscrever no sorteio:",a);const c=E(a)&&((o=(t=a.response)==null?void 0:t.data)!=null&&o.message)?a.response.data.message:"Não foi possível realizar a inscrição. Talvez você já esteja inscrito ou o evento esteja lotado.";m({title:"Erro na Inscrição",message:c,status:"error"}),d(!0)}finally{g({...u,isOpen:!1})}},P=s=>{var o,a;const t=((a=(o=n==null?void 0:n.eventos)==null?void 0:o.find(c=>c.id===s))==null?void 0:a.tema)||"este evento";g({isOpen:!0,title:"Cancelar Inscrição",message:`Tem certeza que deseja remover sua inscrição do evento "${t}"?`,buttonType:"btn-error",onConfirm:()=>X(s)})},X=async s=>{var t;try{await fe(s),n&&p({...n,eventos:((t=n.eventos)==null?void 0:t.filter(o=>o.id!==s))??[]}),m({title:"Inscrição Removida",message:"Sua inscrição foi removida com sucesso.",status:"success"}),d(!0)}catch(o){console.error("Erro ao remover inscrição do sorteio:",o),m({title:"Erro",message:"Não foi possível remover a sua inscrição.",status:"error"}),d(!0)}finally{g({...u,isOpen:!1})}},T=l.useMemo(()=>{var t,o;let s=[];return w==="selecionados"?s=((t=n==null?void 0:n.eventos)==null?void 0:t.filter(a=>{var c;return((c=a.pivot)==null?void 0:c.status)==="contemplado"}))??[]:w==="pendentes"?s=((o=n==null?void 0:n.eventos)==null?void 0:o.filter(a=>{var c;return((c=a.pivot)==null?void 0:c.status)==="inscrito"}))??[]:s=i,j==="Todos"?s:s.filter(a=>a.data===j)},[i,n==null?void 0:n.eventos,w,j]);if(A)return e.jsx("p",{className:"p-8 text-center",children:"Carregando eventos..."});if(M)return e.jsx("p",{className:"p-8 text-center text-red-500",children:M});const Y=new Set(((z=n==null?void 0:n.eventos)==null?void 0:z.map(s=>{var t;return((t=s.pivot)==null?void 0:t.status)==="inscrito"?s.id:null}))??[]),Z=new Set(((D=(O=n==null?void 0:n.eventos)==null?void 0:O.filter(s=>{var t;return((t=s.pivot)==null?void 0:t.status)==="contemplado"}))==null?void 0:D.map(s=>s.id))??[]),ee=()=>{g({isOpen:!0,title:"Realizar Sorteio Geral",message:"Deseja realizar o sorteio geral agora? Esta ação selecionará os alunos para os eventos com vagas limitadas e não pode ser desfeita facilmente.",buttonType:"btn-primary",onConfirm:se})},se=async()=>{var s,t;try{const o=await pe();m({title:"Sorteio Realizado!",message:"O sorteio geral foi concluído com sucesso.",status:"success"}),d(!0),console.log(o.data)}catch(o){console.error(o);const a=E(o)&&((t=(s=o.response)==null?void 0:s.data)!=null&&t.message)?o.response.data.message:"O sorteio não foi realizado devido a um erro.";m({title:"Erro no Sorteio",message:a,status:"error"}),d(!0)}finally{g({...u,isOpen:!1})}},te=()=>{y(!0)},oe=async s=>{if(y(!1),!s){m({title:"Atenção",message:"A senha é obrigatória para esta ação.",status:"error"}),d(!0);return}try{await me(s);const t=await ue();m({title:"Sucesso!",message:"A limpeza dos dados do sorteio foi realizada com sucesso.",status:"success"}),d(!0),console.log(t.data)}catch(t){const o=E(t)&&t.response?t.response.data.message:"Não foi possível concluir a operação devido a um erro inesperado.";m({title:"Falha na Operação",message:o,status:"error"}),d(!0),console.error(t)}};return e.jsxs("div",{className:"w-full min-h-screen p-4 font-sans main sm:p-6 lg:p-8",children:[" ",f&&e.jsxs("div",{role:"alert",className:"mb-4 alert alert-success",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 stroke-current shrink-0",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-semibold",children:f})]}),e.jsxs("h1",{className:"py-3 text-5xl font-bold text-center md:text-5xl text-emerald-800",children:[" ","Programação da Expocanp"]}),r?null:e.jsxs("div",{className:"flex flex-wrap justify-center w-full gap-2 my-6",children:[" ",e.jsx("button",{onClick:()=>C("todos"),className:`px-4 py-2 rounded-lg divpEB font-semibold transition-colors shadow-lg ${w==="todos"?"bg-emerald-600 text-white":"bg-white text-emerald-700 hover:bg-emerald-100"}`,children:"Todos"}),e.jsx("button",{onClick:()=>C("pendentes"),className:`px-4 py-2 rounded-lg divpEB font-semibold transition-colors shadow-lg ${w==="pendentes"?"bg-emerald-600 text-white":"bg-white text-emerald-700 hover:bg-emerald-100"}`,children:"Pendentes"}),e.jsx("button",{onClick:()=>C("selecionados"),className:`px-4 py-2 rounded-lg divpEB font-semibold transition-colors shadow-lg ${w==="selecionados"?"bg-emerald-600 text-white":"bg-white text-emerald-700 hover:bg-emerald-100"}`,children:"Selecionados"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center w-full gap-2 my-6",children:[" ",e.jsx("button",{onClick:()=>b("Todos"),className:`px-4 py-2 divpEB rounded-lg font-semibold transition-colors ${j==="Todos"?"bg-emerald-600 text-white shadow-lg":"bg-white text-emerald-700 hover:bg-emerald-100"}`,children:"Todos os Dias"},"todos-dias"),q.map(s=>e.jsxs("button",{onClick:()=>b(s),className:`px-4 py-2 divpEB rounded-lg font-semibold transition-colors ${j===s?"bg-emerald-600 text-white shadow-lg":"bg-white text-emerald-700 hover:bg-emerald-100"}`,children:[s,"-feira"]},s))]}),T.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:T.map(s=>{const t=Y.has(s.id),o=Z.has(s.id);return e.jsxs("div",{onClick:()=>W(s),className:"flex flex-col justify-between p-6 shadow-lg bg-emerald-50 divpE rounded-2xl eventoD",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-emerald-700",children:s.tema}),e.jsx("p",{className:"mt-2 font-semibold text-gray-600",children:s.horario_inicio}),e.jsxs("p",{className:"font-semibold text-gray-600",children:["Local: ",s.local]}),e.jsx("p",{className:"mt-4 text-gray-700 truncate",children:s.descricao})]}),e.jsx("div",{className:"mt-6",children:r?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),G(s.id)},className:"btn btn-sm btn-success",children:"Modificar"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),K(s.id)},className:"btn btn-sm btn-error",children:"Excluir"})]}):e.jsx("div",{children:t?e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("button",{disabled:!0,className:"flex-grow w-full py-2 font-bold text-white bg-gray-400 rounded-lg cursor-not-allowed sm:w-auto",children:"Pendente"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),P(s.id)},className:"flex-grow w-full py-2 font-bold text-white transition-all rounded-lg sm:w-auto bg-emerald-500 hover:bg-emerald-600",children:"Sair do sorteio"})]}):e.jsx("div",{children:o?e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("button",{disabled:!0,className:"flex-grow w-full py-2 font-bold text-white bg-gray-400 rounded-lg cursor-not-allowed sm:w-auto",children:"Contemplado"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),P(s.id)},className:"flex-grow w-full py-2 font-bold text-white transition-all rounded-lg sm:w-auto bg-emerald-500 hover:bg-emerald-600",children:"Sair do evento"})]}):e.jsx("div",{children:e.jsx("button",{onClick:a=>{a.stopPropagation(),H(s.id)},className:"w-full py-2 font-bold text-white transition-all rounded-lg bg-emerald-500 hover:bg-emerald-600",children:"Participar"})})})})})]},s.id)})}):e.jsx("p",{className:"p-8 text-center text-gray-500",children:"Nenhum evento agendado para este dia."}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx(ie,{to:"/events/add",className:"text-white bg-emerald-600 btn btn-lg",children:"Adicionar Novo Evento"})}),e.jsxs("div",{className:"flex flex-row justify-center gap-4 my-14",children:[e.jsx("button",{onClick:ee,className:"font-bold btn btn-sm btn-error",children:"Sortear"}),e.jsx("button",{onClick:te,className:"font-bold btn btn-sm btn-error",children:"Limpar Sorteio"})]})]}),e.jsx(be,{event:$,onClose:V}),e.jsx(ge,{isOpen:I,onClose:()=>y(!1),onConfirm:oe,title:"Confirmar Limpeza do Sorteio",message:"Esta ação é irreversível e irá apagar todos os alunos inscritos e selecionados da rodada atual. Para continuar, digite sua senha de administrador."}),e.jsx(je,{isOpen:F,onClose:()=>{d(!1)},title:N.title,message:N.message,status:N.status}),e.jsx(we,{isOpen:u.isOpen,onClose:()=>g({...u,isOpen:!1}),onConfirm:u.onConfirm,title:u.title,message:u.message,confirmButtonText:u.buttonType==="btn-error"?"Excluir":"Confirmar",confirmButtonType:u.buttonType})]})}export{Ce as default};
